import { CheckBox, ListView, LineEdit, Palette, Button, StandardButton, Switch } from "std-widgets.slint";

export struct TodoItem {
  task: string,
  checked: bool,
}

export global AppConfig {
  in-out property<bool> dark-theme: true;
  out property<relative-font-size> font_size: 2rem;
  in property<[TodoItem]> todos: [];
}

export component AppWindow inherits Window {

  callback theme_init();
  callback add_task_cb(string);
  min-width: 600px;
  min-height: 600px;
  title: "2do-app";

  theme_init => {
    Palette.color-scheme = AppConfig.dark-theme ? ColorScheme.dark : ColorScheme.light;
  }
  VerticalLayout {
    padding: 15px;
    spacing: 5px;
    HorizontalLayout {
      title_text := Text {
        font-size: AppConfig.font_size;
        text: "Todos: ";
      }
      Rectangle{}
      Switch {
        text: "Dark theme";
        checked: AppConfig.dark-theme;
        toggled => {
          AppConfig.dark-theme = self.checked ? true : false;
          Palette.color-scheme = self.checked ? ColorScheme.dark : ColorScheme.light;
        }
      }
    }
    HorizontalLayout {
      search_task_in := LineEdit {
        accepted(task) => {
          root.add_task_cb(task);
        }
        placeholder-text: "Search task";
      }
      search_task_btn := Button {
        text: "Search";
      }
    }
    add_task_btn := Button {
      text: "Add task";
      clicked => {
      }
    }
    todo_list := ListView {
      for todo in AppConfig.todos: HorizontalLayout {
        CheckBox {
          toggled => {
            todo.checked = self.checked;
          }
          text: todo.task;
          checked: todo.checked;
        }
      }
    }
  }
}
